<?xml version="1.0" encoding="UTF-8"?>
<!-- Configures the Camel Context -->

<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="
       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
       http://camel.apache.org/schema/spring http://camel.apache.org/schema/spring/camel-spring.xsd">

	<!-- client init factory -->
	<bean id="clientInitFactory" class="co.kr.init.client.ClientInitFactory" />
	<bean id="serverInitFactory" class="co.kr.init.server.ServerInitFactory" />


	<!-- test data make -->
	<bean id="getByteBuf" class="co.kr.vo.ByteBufFactory" init-method="getByteBuf" />
	<bean id="getString" class="co.kr.vo.StringFactory" init-method="getString" />
	<bean id="getByteArr" class="co.kr.vo.ByteArrFactory" init-method="getByteArr" />
	
	<!-- convert  -->
	<bean id="stringToByteBuf_Convert" class="co.kr.converter.StringToByteBuf" />
	
	<camelContext xmlns="http://camel.apache.org/schema/spring" >
		<route>
			<from uri="timer://BANK?repeatCount=1" />
			<to   uri="direct:start" />
		</route>

		<route>
			<from uri="direct:start" />
			<bean ref="getString" />
			<!-- <bean ref="getByteBuf" /> -->
			<bean ref="stringToByteBuf_Convert" />
			<to   uri="netty4:tcp://localhost:22222?workerCount=1&amp;clientPipelineFactory=#clientInitFactory" />
		</route>

		<!-- camel netty4 tcp -->
		<route>
			<from uri="netty4:tcp://localhost:22222?workerCount=1&amp;serverPipelineFactory=#serverInitFactory" />
			<log message="[SERVER]message:${body}" loggingLevel="DEBUG"></log>
		</route>
	</camelContext>

</beans>




<!-- 단순 샘플 case 1 start -->
<!-- <route> <from uri="timer://BANK?repeatCount=1" /> <setBody> <simple>sample 
	value=======>>>></simple> </setBody> <to uri="netty4:tcp://localhost:1111?textline=true&amp;sync=true&amp;usingExecutorService=false"/> 
	</route> <route> <from uri="netty4:tcp://localhost:1111?textline=true&amp;sync=true&amp;usingExecutorService=false"/> 
	<to uri="log:result"/> </route> -->
<!-- 단순 샘플 case 1 end -->

<!-- <route> <from uri="netty:tcp://0.0.0.0:30000" /> <to uri="stream:err" 
	/> <convertBodyTo type="java.lang.String" charset="euc-kr" /> <convertBodyTo 
	type="byte[]" /> <to uri="file:target/recevied?fileName=data-${date:now:yyyyMMdd-HHmmssSSS}.xml&amp;charset=euc-kr" 
	/> </route> <route> <from uri="file:src/data?noop=true"/> <choice> <when> 
	<xpath>/person/city = 'London'</xpath> <log message="UK message"/> <to uri="file:target/messages/uk"/> 
	</when> <otherwise> <log message="Other message"/> <to uri="file:target/messages/others"/> 
	</otherwise> </choice> <convertBodyTo type="java.lang.String" /> <convertBodyTo 
	type="byte[]" /> <to uri="netty:tcp://0.0.0.0:30000" /> <to uri="stream:err" 
	/> </route> -->
