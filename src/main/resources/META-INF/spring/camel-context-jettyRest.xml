<?xml version="1.0" encoding="UTF-8"?>


<!--
	@heojea 20171215
	@Auth : 허재연
	@DESC : jetty 기반의 http rest 서버를 만들도록 한다. client는 별도로 만들지 않고 본 페이지에 만들도록 할것이다.
-->
<beans xmlns="http://www.springframework.org/schema/beans"
	   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	   xsi:schemaLocation="
       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
       http://camel.apache.org/schema/spring http://camel.apache.org/schema/spring/camel-spring.xsd">

	<!-- 스프링 빈을 이용하여 프로세서를 정의한다.-->
	<bean id="helloProcess" class="co.kr.jettyRest.process.HelloProcess" />

	<camelContext xmlns="http://camel.apache.org/schema/spring">
		<!-- 레스트 서버로 활용될 서저를 지정하고 옵션을 정의 한다. -->
		<restConfiguration component="jetty" host="localhost" port="9090" bindingMode="json"  enableCORS="true">
			<dataFormatProperty key="json.in.disableFeatures" value="FAIL_ON_UNKNOWN_PROPERTIES,ADJUST_DATES_TO_CONTEXT_TIME_ZONE"/>
			<dataFormatProperty key="json.in.enableFeatures" value="FAIL_ON_NUMBERS_FOR_ENUMS,USE_BIG_DECIMAL_FOR_FLOATS"/>
		</restConfiguration>

		<!-- 레스트 경로를 설정하는부분 document화 시켜야 한다. -->
		<rest path="/say">
			<get uri="/hello" consumes="application/json">
				<to uri="direct:hello"/>
			</get>
			<!--<get uri="/bye" consumes="application/json">
				<to uri="direct:bye"/>
			</get>-->
			<post uri="/bye" consumes="application/json">
				<to uri="mock:update"/>
			</post>
		</rest>

		<!-- router 정의 부분  -->
		<route>
			<from uri="direct:hello"/>
			<process ref="helloProcess" />
			<!-- <transform>
				<simple>${body}</simple>
			</transform> -->
		</route>

		<route>
			<from uri="direct:bye"/>
			<process ref="helloProcess" />
		</route>
	</camelContext>
</beans>